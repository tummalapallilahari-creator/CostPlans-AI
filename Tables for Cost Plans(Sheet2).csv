Table_name,column_names,Primary key,parent_tables ,child tables,foreign key,One-to-many relationships,table description
planning_years,"planning_year_id, year, start_date, end_date, status, is_active, created_at, updated_at",planning_year_id,Master table,"project_metadata, user_project_access",(none),planning_years (1) -> project_metadata (many); planning_years (1) -> user_project_access (many),"Defines each planning cycle (ex: 2025, 2026) and its lifecycle status (draft/open/closed)."
projects,"project_id, wbse_code, project_name, description, status, created_at, updated_at",project_id,Master table,"project_metadata, user_project_access",(none),projects (1) -> project_metadata (many); projects (1) -> user_project_access (many),Stable registry of projects. WBSE lives here as the business identifier.
project_metadata,"project_metadata_id, project_id, planning_year_id, division, branch, section_country, region, implementing_grant, trust_fund, earmarking, project_end_date, remarks, created_at, updated_at",project_metadata_id,"projects, planning_years",(future: almost every transactional table),project_id ? projects.project_id; planning_year_id ? planning_years.planning_year_id,projects (1) -> project_metadata (many); planning_years (1) -> project_metadata (many),Working context table: stores year-specific org + funding attributes for a project. This is what everything in a cost plan should hang off.
users,"user_id, full_name, email, is_active, created_at, updated_at",user_id,Master table,user_project_access,(none),users (1) -> user_project_access (many),"System user registry (finance users, reviewers, admins)."
roles,"role_id, role_name, description, created_at, updated_at",role_id,Master table,user_project_access,(none),roles (1) -> user_project_access (many),"Defines role types and permissions grouping (finance_editor, reviewer, viewer, admin)."
user_project_access,"user_project_access_id, user_id, role_id, project_id, planning_year_id (nullable), access_level, created_at, updated_at",user_project_access_id,"users, roles, projects, (optional) planning_years",(none in this set),user_id ? users.user_id; role_id ? roles.role_id; project_id ? projects.project_id; planning_year_id ? planning_years.planning_year_id (nullable),users (1) -> user_project_access (many); projects (1) -> user_project_access (many); roles (1) -> user_project_access (many); planning_years (1) -> user_project_access (many),"Maps users to the projects they can access (“My Projects”), with a role. Can optionally be year-scoped (nullable year means access across years)."
countries,"country_id, country_name, iso2, iso3, region, is_active, created_at, updated_at",country_id,Master table,"duty_stations, (future: project_metadata, salary tables)",(none),countries (1) -> duty_stations (many),"Country reference table used for metadata, duty-stations, salary parameters, reporting filters."
duty_stations,"duty_station_id, duty_station_name, duty_station_code, country_id, is_hq, is_active, created_at, updated_at",duty_station_id,countries,"(future: staffing, salary sets)",country_id ? countries.country_id,countries (1) -> duty_stations (many),"Duty station reference with mapping to country/region and HQ flag (Geneva, Nairobi, etc.)."
staff_categories,"staff_category_id, staff_category_code, staff_category_name, description, is_active, created_at, updated_at",staff_category_id,Master table,"grades, (future: staffing, salary parameters)",(none),staff_categories (1) -> grades (many),Controlled list of staff categories (P/GS/NO/UNV).
grades,"grade_id, staff_category_id, grade_code, grade_rank, is_active, created_at, updated_at",grade_id,staff_categories,"(future: staffing, salary parameters)",staff_category_id ? staff_categories.staff_category_id,staff_categories (1) -> grades (many),"Grade list per staff category (P-2..D-2, G-1..G-7, etc.)."
umoja_classes,"umoja_class_id, umoja_class_code, umoja_class_name, description, is_active, created_at, updated_at",umoja_class_id,Master table,"(future: opc_items, activity_costs, summary_lines)",(none),umoja_classes (1) -> (many rows in transactional cost tables),"Reference list of Umoja class codes (010, 155, etc.) used to classify costs consistently."
cost_categories,"cost_category_id, category_code, category_name, display_order, is_active, created_at, updated_at",cost_category_id,Master table,cost_subcategories,(none),cost_categories (1) -> cost_subcategories (many),"High-level reporting categories (Staff Personnel, Activities & Operating Costs, Grants)."
cost_subcategories,"cost_subcategory_id, cost_category_id, subcategory_code, subcategory_name, display_order, is_active, created_at, updated_at",cost_subcategory_id,cost_categories,(future: summary_lines mapping),cost_category_id ? cost_categories.cost_category_id,cost_categories (1) -> cost_subcategories (many),"Subcategories under a category, used for stable rollups and reporting labels."
commitment_items,"commitment_item_id, commitment_item_code, commitment_item_name, description, is_active, created_at, updated_at",commitment_item_id,Master table,(future: opc_items),(none),commitment_items (1) -> (many opc_items),Reference list of Umoja commitment items for cost classification and exports.
imis_object_codes,"imis_object_code_id, imis_object_code, imis_object_name, description, is_active, created_at, updated_at",imis_object_code_id,Master table,(future: opc_items),(none),imis_object_codes (1) -> (many opc_items),Reference list of IMIS object codes used in operating cost lines.
salary_parameter_sets,"salary_parameter_set_id, planning_year_id, country_id, duty_station_id, set_name, version_label, effective_from, effective_to, is_active, created_at, created_by",salary_parameter_set_id,"planning_years, countries, duty_stations, users","salary_parameters, project_parameters",planning_year_id ? planning_years.planning_year_id; country_id ? countries.country_id; duty_station_id ? duty_stations.duty_station_id; created_by ? users.user_id,planning_years (1) ? salary_parameter_sets (many); duty_stations (1) ? salary_parameter_sets (many); salary_parameter_sets (1) ? salary_parameters (many),Groups salary parameters by year + location (and optional version/effective dates).
salary_parameters,"salary_parameter_id, salary_parameter_set_id, staff_category_id, grade_id, component_code, numeric_value, currency_code, unit, notes, created_at",salary_parameter_id,"salary_parameter_sets, staff_categories, grades",(none directly),salary_parameter_set_id ? salary_parameter_sets.salary_parameter_set_id; staff_category_id ? staff_categories.staff_category_id; grade_id ? grades.grade_id,salary_parameter_sets (1) ? salary_parameters (many); grades (1) ? salary_parameters (many),"Stores the actual salary numbers/multipliers per set, by category + grade + component (NET_BASE, CSC_MULT, POST_ADJ, EXCHANGE_RATE, etc.)."
project_parameters,"project_parameter_id, project_metadata_id, inflation_rate, psc_rate, default_currency, default_salary_parameter_set_id, assumptions_notes, created_at, updated_at",project_parameter_id,"project_metadata, salary_parameter_sets",(none directly),project_metadata_id ? project_metadata.project_metadata_id; default_salary_parameter_set_id ? salary_parameter_sets.salary_parameter_set_id,project_metadata (1) ? project_parameters (1) (typically 1:1); salary_parameter_sets (1) ? project_parameters (many),"Per project-year assumptions: inflation, PSC rate, default currency, and default salary set."
positions,"position_id, position_title, staff_category_id, grade_id, default_duty_station_id, is_active, source_system, created_at",position_id,"staff_categories, grades, duty_stations","project_positions, staffing_plan, deployment_lines, staff_costing",staff_category_id ? staff_categories.staff_category_id; grade_id ? grades.grade_id; default_duty_station_id ? duty_stations.duty_station_id,positions (1) ? project_positions (many); positions (1) ? staffing_plan (many); positions (1) ? deployment_lines (many),"Master list of positions (Position ID as business key), with baseline attributes."
project_positions,"project_position_id, project_metadata_id, position_id, allowed_from, allowed_to, source, created_at",project_position_id,"project_metadata, positions",(none directly),project_metadata_id ? project_metadata.project_metadata_id; position_id ? positions.position_id,project_metadata (1) ? project_positions (many); positions (1) ? project_positions (many),Defines which positions are allowed for a given project-year (validation/guardrail).
staffing_plan,"staffing_plan_id, project_metadata_id, position_id, staff_category_id, grade_id, duty_station_id, funding_start, funding_end, allocation_percent, is_filled, notes, created_at, updated_at",staffing_plan_id,"project_metadata, positions, staff_categories, grades, duty_stations",(feeds derived tables via calc runs),project_metadata_id ? project_metadata.project_metadata_id; position_id ? positions.position_id; staff_category_id ? staff_categories.staff_category_id; grade_id ? grades.grade_id; duty_station_id ? duty_stations.duty_station_id,project_metadata (1) ? staffing_plan (many); positions (1) ? staffing_plan (many),Editable planning input for staffing per project-year-position (what finance actually edits).
deployment_lines,"deployment_line_id, project_metadata_id, position_id, staff_category_id, grade_id, duty_station_id, allocation_basis, default_percent, notes, created_at",deployment_line_id,"project_metadata, positions, staff_categories, grades, duty_stations","deployment_monthly_allocations, allocation_rules",project_metadata_id ? project_metadata.project_metadata_id; position_id ? positions.position_id; staff_category_id ? staff_categories.staff_category_id; grade_id ? grades.grade_id; duty_station_id ? duty_stations.duty_station_id,deployment_lines (1) ? deployment_monthly_allocations (many); deployment_lines (1) ? allocation_rules (many),"Allocation “lines” per project-year, either position-based or grade/category-based."
deployment_monthly_allocations,"deployment_month_id, deployment_line_id, month_start, post_month_value, is_derived, derived_from_rule_id, created_at",deployment_month_id,"deployment_lines, allocation_rules",(none directly),deployment_line_id ? deployment_lines.deployment_line_id; derived_from_rule_id ? allocation_rules.allocation_rule_id,deployment_lines (1) ? deployment_monthly_allocations (many); allocation_rules (1) ? deployment_monthly_allocations (many),Month-by-month allocation values (manual or derived) used for post-month and time distribution.
allocation_rules,"allocation_rule_id, deployment_line_id, rule_type, start_date, end_date, percent, rounding_mode, notes, created_at",allocation_rule_id,deployment_lines,deployment_monthly_allocations,deployment_line_id ? deployment_lines.deployment_line_id,deployment_lines (1) ? allocation_rules (many); allocation_rules (1) ? deployment_monthly_allocations (many),Optional rules to generate monthly allocations from date ranges/percentages (reduces manual month entry).
opc_items,"opc_item_id, project_metadata_id, item_label, umoja_class_id, cost_category_id, cost_subcategory_id, commitment_item_id, imis_object_code_id, unit, unit_rate, quantity, duration, annual_amount, notes, created_at, updated_at",opc_item_id,"project_metadata, umoja_classes, cost_categories, cost_subcategories, commitment_items, imis_object_codes",opc_quarter_allocations,project_metadata_id ? project_metadata.project_metadata_id; umoja_class_id ? umoja_classes.umoja_class_id; cost_category_id ? cost_categories.cost_category_id; cost_subcategory_id ? cost_subcategories.cost_subcategory_id; commitment_item_id ? commitment_items.commitment_item_id; imis_object_code_id ? imis_object_codes.imis_object_code_id,project_metadata (1) ? opc_items (many); opc_items (1) ? opc_quarter_allocations (1),Non-staff cost items per project-year with classification and base amount calculation inputs.
opc_quarter_allocations,"opc_quarter_id, opc_item_id, q1, q2, q3, q4, annual_total, created_at",opc_quarter_id,opc_items,(none directly),opc_item_id ? opc_items.opc_item_id,opc_items (1) ? opc_quarter_allocations (1),Quarter distribution for an OPC item (Q1–Q4) when not derived automatically.
opc_templates,"opc_template_id, template_name, item_label, umoja_class_id, commitment_item_id, imis_object_code_id, default_unit, default_unit_rate, is_active, created_at",opc_template_id,"umoja_classes, commitment_items, imis_object_codes","(used by template init logic, not direct FK children)",umoja_class_id ? umoja_classes.umoja_class_id; commitment_item_id ? commitment_items.commitment_item_id; imis_object_code_id ? imis_object_codes.imis_object_code_id,umoja_classes (1) ? opc_templates (many),Template definitions used to initialize OPC items for a new project-year plan.
activities,"activity_id, project_metadata_id, activity_code, activity_label, owner_user_id, result_ref, created_at, updated_at",activity_id,"project_metadata, users",activity_costs,project_metadata_id ? project_metadata.project_metadata_id; owner_user_id ? users.user_id,project_metadata (1) ? activities (many); activities (1) ? activity_costs (many),"Activity definitions per project-year (labels, ownership, optional results references)."
activity_costs,"activity_cost_id, activity_id, umoja_class_id, cost_category_id, cost_subcategory_id, q1, q2, q3, q4, annual_total, notes, created_at",activity_cost_id,"activities, umoja_classes, cost_categories, cost_subcategories",(none directly),activity_id ? activities.activity_id; umoja_class_id ? umoja_classes.umoja_class_id; cost_category_id ? cost_categories.cost_category_id; cost_subcategory_id ? cost_subcategories.cost_subcategory_id,activities (1) ? activity_costs (many); umoja_classes (1) ? activity_costs (many),"Quarterly/annual allocations tied to activities, classified for reporting."
scenarios,"scenario_id, project_metadata_id, scenario_name, scenario_type, is_active, created_by, created_at",scenario_id,"project_metadata, users","scenario_overrides, versions, staff_costing, psc_calculations, summary_lines, rollup_totals, calculation_runs",project_metadata_id ? project_metadata.project_metadata_id; created_by ? users.user_id,project_metadata (1) ? scenarios (many); scenarios (1) ? scenario_overrides (many),Baseline + what-if scenarios per project-year (separates plan from experimentation).
scenario_overrides,"scenario_override_id, scenario_id, target_table, target_record_id, target_field, old_value, new_value, reason, created_by, created_at",scenario_override_id,"scenarios, users",(none directly),scenario_id ? scenarios.scenario_id; created_by ? users.user_id,scenarios (1) ? scenario_overrides (many),"Generic override layer that records what changed, where, and why for a scenario."
versions,"version_id, project_metadata_id, scenario_id, version_label, status, frozen_at, frozen_by, notes, created_at",version_id,"project_metadata, scenarios, users",calculation_runs,project_metadata_id ? project_metadata.project_metadata_id; scenario_id ? scenarios.scenario_id; frozen_by ? users.user_id,project_metadata (1) ? versions (many); scenarios (1) ? versions (many),Immutable snapshots/releases (draft/submitted/approved) for governance and audit.
staff_costing,"staff_costing_id, project_metadata_id, scenario_id, position_id, staff_category_id, grade_id, umoja_class_id, q1, q2, q3, q4, annual_total, calculation_run_id, created_at",staff_costing_id,"project_metadata, scenarios, positions, staff_categories, grades, umoja_classes, calculation_runs",(none directly),project_metadata_id ? project_metadata.project_metadata_id; scenario_id ? scenarios.scenario_id; position_id ? positions.position_id; staff_category_id ? staff_categories.staff_category_id; grade_id ? grades.grade_id; umoja_class_id ? umoja_classes.umoja_class_id; calculation_run_id ? calculation_runs.calculation_run_id,calculation_runs (1) ? staff_costing (many); scenarios (1) ? staff_costing (many),"Computed staff costs (usually Umoja 010) per scenario, produced by calc engine."
psc_calculations,"psc_calc_id, project_metadata_id, scenario_id, psc_rate, base_amount, psc_amount, calculation_run_id, created_at",psc_calc_id,"project_metadata, scenarios, calculation_runs",(none directly),project_metadata_id ? project_metadata.project_metadata_id; scenario_id ? scenarios.scenario_id; calculation_run_id ? calculation_runs.calculation_run_id,calculation_runs (1) ? psc_calculations (many); scenarios (1) ? psc_calculations (many),"Computed PSC (Umoja 155) per scenario, tied to the run that produced it."
summary_lines,"summary_line_id, project_metadata_id, scenario_id, umoja_class_id, cost_category_id, cost_subcategory_id, line_label, q1, q2, q3, q4, annual_total, calculation_run_id, created_at",summary_line_id,"project_metadata, scenarios, umoja_classes, cost_categories, cost_subcategories, calculation_runs",(none directly),project_metadata_id ? project_metadata.project_metadata_id; scenario_id ? scenarios.scenario_id; umoja_class_id ? umoja_classes.umoja_class_id; cost_category_id ? cost_categories.cost_category_id; cost_subcategory_id ? cost_subcategories.cost_subcategory_id; calculation_run_id ? calculation_runs.calculation_run_id,calculation_runs (1) ? summary_lines (many); project_metadata (1) ? summary_lines (many),Final reporting lines per scenario (Category/Subcategory/Umoja) for dashboards/export.
rollup_totals,"rollup_total_id, planning_year_id, scenario_id, division, branch, section_country, country_id, cost_category_id, umoja_class_id, annual_total, calculation_run_id, created_at",rollup_total_id,"planning_years, scenarios, countries, cost_categories, umoja_classes, calculation_runs",(none directly),planning_year_id ? planning_years.planning_year_id; scenario_id ? scenarios.scenario_id; country_id ? countries.country_id; cost_category_id ? cost_categories.cost_category_id; umoja_class_id ? umoja_classes.umoja_class_id; calculation_run_id ? calculation_runs.calculation_run_id,planning_years (1) ? rollup_totals (many); calculation_runs (1) ? rollup_totals (many),Pre-aggregated totals across org dimensions for fast reporting (division/branch/country).
audit_log,"audit_log_id, actor_user_id, action, table_name, record_id, field_name, old_value, new_value, reason, created_at",audit_log_id,users,(none),actor_user_id ? users.user_id,users (1) ? audit_log (many),Records data change events for governance: who/what/when/before-after.
calculation_runs,"calculation_run_id, project_metadata_id, scenario_id, version_id, run_status, started_at, finished_at, triggered_by, input_hash, error_message, notes",calculation_run_id,"project_metadata, scenarios, versions, users","staff_costing, psc_calculations, summary_lines, rollup_totals",project_metadata_id ? project_metadata.project_metadata_id; scenario_id ? scenarios.scenario_id; version_id ? versions.version_id; triggered_by ? users.user_id,scenarios (1) ? calculation_runs (many); calculation_runs (1) ? summary_lines (many),Recompute execution history and linkage anchor for all derived outputs.
data_import_jobs,"data_import_job_id, job_type, project_metadata_id, started_at, finished_at, status, records_fetched, records_inserted, records_updated, records_failed, error_message, raw_payload_ref, triggered_by, created_at",data_import_job_id,"project_metadata, users",(none),project_metadata_id ? project_metadata.project_metadata_id; triggered_by ? users.user_id,project_metadata (1) ? data_import_jobs (many); users (1) ? data_import_jobs (many),"Tracks external import/sync runs (Umoja) with counts, failures, and payload reference."
